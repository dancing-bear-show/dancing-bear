curated:
  maintenance:
    - id: inventory_refresh
      desc: Refresh inventory
      cmd: ./bin/llm inventory --preserve
    - id: derive_all
      desc: Regenerate all .llm artifacts
      cmd: ./bin/llm derive-all --out-dir .llm --include-generated
    - id: stale_most
      desc: Most-stale (by area)
      cmd: ./bin/llm stale --with-status --limit 10
    - id: deps_hotspots
      desc: Dependency hotspots
      cmd: ./bin/llm deps --by combined --order desc --limit 10
    - id: sla_check
      desc: Fail build on stale
      cmd: ./bin/llm check --fail-on-stale
    - id: agentic_full
      desc: Full agentic capsule
      cmd: ./bin/llm agentic --stdout
    - id: agentic_compact
      desc: Compact agentic capsule (token-efficient)
      cmd: ./bin/llm agentic --stdout --compact

  onboarding:
    - id: creds_example
      desc: Copy example Gmail creds
      cmd: ./bin/mail-assistant env setup --no-venv --skip-install --copy-gmail-example
    - id: auth_gmail_validate
      desc: Gmail token validate (non-interactive)
      cmd: ./bin/mail-assistant --profile gmail_personal auth --validate
    - id: auth_outlook_ensure_validate
      desc: Outlook device-code ensure + validate
      steps:
        - ./bin/mail-assistant --profile outlook_personal outlook auth ensure
        - ./bin/mail-assistant --profile outlook_personal outlook auth validate

  mail:
    - id: unified_derive
      desc: Derive provider configs from unified
      cmd: ./bin/mail-assistant config derive filters --in config/filters_unified.yaml --out-gmail out/filters.gmail.from_unified.yaml --out-outlook out/filters.outlook.from_unified.yaml

    - id: gmail_filters_plan_apply_verify
      desc: Gmail Filters — Plan → Apply → Verify
      steps:
        - ./bin/mail-assistant filters plan --config out/filters.gmail.from_unified.yaml --delete-missing
        - ./bin/mail-assistant filters sync --config out/filters.gmail.from_unified.yaml --delete-missing
        - ./bin/mail-assistant filters export --out out/filters.gmail.export.after.yaml

    - id: outlook_rules_plan_apply_verify
      desc: Outlook Rules — Plan → Apply → Verify
      steps:
        - ./bin/mail-assistant outlook rules plan --config out/filters.outlook.from_unified.yaml --move-to-folders
        - ./bin/mail-assistant outlook rules sync --config out/filters.outlook.from_unified.yaml --move-to-folders --delete-missing
        - ./bin/mail-assistant outlook rules list

    - id: gmail_labels_plan_apply_verify
      desc: Gmail Labels — Plan → Apply → Verify
      steps:
        - ./bin/mail-assistant labels plan --config config/labels_current.yaml --delete-missing
        - ./bin/mail-assistant labels sync --config config/labels_current.yaml --delete-missing
        - ./bin/mail-assistant labels export --out out/labels.export.after.yaml

    - id: gmail_signatures_export_normalize_sync
      desc: Gmail Signatures — Export → Normalize → Sync
      steps:
        - ./bin/mail-assistant signatures export --out out/signatures.export.yaml
        - ./bin/mail-assistant signatures normalize --config config/signatures.yaml --out-html out/signature.preview.html
        - ./bin/mail-assistant signatures sync --config config/signatures.yaml

    - id: gmail_forwarding_list_add_status
      desc: Gmail Forwarding — List/Add/Status
      cmd: ./bin/mail-assistant forwarding list

    - id: gmail_auto_propose_summary_apply
      desc: Gmail Auto (categorize+archive) — Propose → Summary → Apply (dry-run)
      steps:
        - ./bin/mail-assistant auto propose --out out/auto.proposal.json --days 7 --only-inbox --dry-run
        - ./bin/mail-assistant auto summary --proposal out/auto.proposal.json
        - ./bin/mail-assistant auto apply --proposal out/auto.proposal.json --cutoff-days 7 --dry-run

  testing:
    - id: tests_all
      desc: Run all tests (verbose)
      cmd: python3 -m unittest -v

  ios_phone:
    - id: ios_export_layout
      desc: Export current Home Screen layout from Finder backup
      cmd: ./bin/phone-assistant export --out out/ios.IconState.yaml
    - id: ios_scaffold_plan
      desc: Scaffold plan (pins + folders) from exported layout
      cmd: ./bin/phone-assistant plan --layout out/ios.IconState.yaml --out out/ios.plan.yaml
    - id: ios_manual_checklist
      desc: Generate manual move checklist from plan + layout
      cmd: ./bin/phone-assistant checklist --plan out/ios.plan.yaml --layout out/ios.IconState.yaml --out out/ios.checklist.txt
    - id: ios_profile_build
      desc: Build Home Screen Layout configuration profile (.mobileconfig)
      cmd: ./bin/phone-assistant profile build --plan out/ios.plan.yaml --layout out/ios.IconState.yaml --out out/ios.hslayout.mobileconfig --identifier com.example.profile --hs-identifier com.example.hslayout --display-name "Home Screen Layout" --organization "Personal"
    - id: ios_unused_candidates
      desc: Suggest rarely-used app candidates (heuristic)
      cmd: ./bin/phone-assistant unused --layout out/ios.IconState.yaml --limit 50
    - id: ios_unused_prune_offload
      desc: Generate OFFLOAD checklist (no device writes)
      cmd: ./bin/phone-assistant prune --layout out/ios.IconState.yaml --mode offload --limit 50
    - id: ios_unused_prune_delete
      desc: Generate DELETE checklist (no device writes)
      cmd: ./bin/phone-assistant prune --layout out/ios.IconState.yaml --mode delete --limit 50
    - id: ios_analyze_layout
      desc: Analyze layout balance and folder structure
      cmd: ./bin/phone-assistant analyze --layout out/ios.IconState.yaml
    - id: ios_auto_folders
      desc: Auto-assign apps into folders and distribute folders across pages
      steps:
        - ./bin/phone-assistant auto-folders --layout out/ipad.IconState.yaml --plan out/ipad.plan.yaml --place-folders-from-page 2
        - ./bin/ios-pages-sync --plan out/ipad.plan.yaml --layout out/ipad.IconState.yaml --out out/ipad.hslayout.mobileconfig
